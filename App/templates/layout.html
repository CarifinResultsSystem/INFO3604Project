<!doctype html>
<html lang="en">
  <head>
    <!-- ---------------- META ---------------- -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- ---------------- TITLE ---------------- -->
    <title>{% block title %}CariFin Results & Scoring System{% endblock %}</title>

    <!-- ---------------- FONTS & STYLES ---------------- -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='layout.css') }}">
  </head>

  <body>
    <!-- ---------------- MOBILE TOP NAV ---------------- -->
  <nav class="purple top-nav">
    <div class="nav-wrapper">
      <!-- Menu button -->
      <a href="#" data-target="mobile-sidenav" class="sidenav-trigger left">
        <i class="material-icons">menu</i>
      </a>

      <!-- Brand icon + text next to menu -->
      <a href="#" class="brand-logo mobile-brand">
        <i class="material-icons left">query_stats</i>
        CariFin
      </a>

      <!-- Login/Logout button -->
      <ul class="right">
        <li>
          {% if is_authenticated %}
            <a href="/logout" class="white-text">
              <i class="material-icons left">logout</i>Logout
            </a>
          {% else %}
            <a href="/login" class="white-text">
              <i class="material-icons left">login</i>Login
            </a>
          {% endif %}
        </li>
      </ul>
    </div>
  </nav>

    <!-- ---------------- DESKTOP SIDEBAR ---------------- -->
    <ul id="desktop-sidenav" class="sidenav sidenav-fixed purple lighten-1">

      <div class="menu-top">
        <!-- Header: logo icon + brand name -->
        <li>
          <div class="sidenav-header">
            <i class="material-icons brand-icon">query_stats</i>
            <a href="{{ url_for('index_views.index_page') }}" class="brand">CariFin</a>
          </div>
        </li>

        <li><div class="divider-custom"></div></li>

        <!-- Collapse toggle -->
        <li>
          <a href="javascript:void(0);" class="desktop-collapse-btn" onclick="toggleMenu()" aria-label="Toggle menu">
            <i class="material-icons">menu</i>
            <span class="btn-label">Collapse Menu</span>
          </a>
        </li>

        <!-- Menu Links -->
        <li>
          <a href="{{ url_for('index_views.index_page') }}">
            <i class="material-icons">dashboard</i>
            <span>Dashboard</span>
          </a>
        </li>
        <li>
          <a href="#">
            <i class="material-icons">leaderboard</i>
            <span>Leaderboard</span>
          </a>
        </li>
        <li>
          <a href="#">
            <i class="material-icons">event</i>
            <span>Schedule</span>
          </a>
        </li>
        <li>
          <a href="#">
            <i class="material-icons">groups</i>
            <span>Participants</span>
          </a>
        </li>
      </div>

      <div class="menu-bottom">
        <li>
          <a href="#">
            <i class="material-icons">settings</i>
            <span>Settings</span>
          </a>
        </li>
        <div class="divider-custom"></div>
        <li>
          {% if is_authenticated %}
            <a href="/logout">
              <i class="material-icons">logout</i>
              <span>Logout</span>
            </a>
          {% else %}
            <a href="/login">
              <i class="material-icons">login</i>
              <span>Login</span>
            </a>
          {% endif %}
        </li>
      </div>
    </ul>

    <!-- ---------------- MOBILE SIDENAV ---------------- -->
    <ul id="mobile-sidenav" class="sidenav purple lighten-1 mobile-flex">
      <!-- Header: logo + brand + close button -->
      <li>
        <div class="sidenav-header">
          <i class="material-icons brand-icon">query_stats</i>
          <a href="#" class="brand">CariFin</a>
          <button id="mobile-close-btn" class="collapse-btn" aria-label="Close menu">
            <i class="material-icons">chevron_left</i>
          </button>
        </div>
      </li>

      <li><div class="divider-custom" style="margin: 0 16px;"></div></li>

      <!-- Menu Links -->
      <li><a href="#"><i class="material-icons">dashboard</i>Dashboard</a></li>
      <li><a href="#"><i class="material-icons">leaderboard</i>Leaderboard</a></li>
      <li><a href="#"><i class="material-icons">event</i>Schedule</a></li>
      <li><a href="#"><i class="material-icons">groups</i>Participants</a></li>

      <li class="mobile-spacer"></li>

      <li><a href="#"><i class="material-icons">settings</i>Settings</a></li>
    </ul>

    <!-- ---------------- MAIN CONTENT ---------------- -->
    <main id="main-content">
      {% block content %}{% endblock %}
    </main>

    <!-- ---------------- SCRIPTS ---------------- -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Initialize sidenavs
        var sidenavElems = document.querySelectorAll('.sidenav');
        var sidenavInstances = M.Sidenav.init(sidenavElems);

        // Mobile close button
        document.getElementById('mobile-close-btn').addEventListener('click', function () {
          var mobileInstance = M.Sidenav.getInstance(document.getElementById('mobile-sidenav'));
          if (mobileInstance) mobileInstance.close();
        });

        // Close mobile sidenav when a link is clicked
        document.querySelectorAll('#mobile-sidenav a').forEach(function (link) {
          link.addEventListener('click', function () {
            var mobileInstance = M.Sidenav.getInstance(document.getElementById('mobile-sidenav'));
            if (mobileInstance) mobileInstance.close();
          });
        });

        // Ensure sidenav closes on window resize above mobile
        window.addEventListener('resize', function () {
          if (window.innerWidth > 992) {
            sidenavInstances.forEach(function (instance) {
              if (instance.isOpen) instance.close();
            });
          }
        });
      });

      // Desktop sidebar toggle
      function toggleMenu() {
        var sidenav = document.getElementById('desktop-sidenav');
        var main = document.getElementById('main-content');

        var isCollapsed = sidenav.classList.toggle('collapsed');
        main.classList.toggle('sidebar-collapsed', isCollapsed);
      }
    </script>
  </body>
</html>